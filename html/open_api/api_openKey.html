<!DOCTYPE html>
<html lang="ko-KR">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, user-scalable=yes, initial-scale=1.0, maximun-scale=3.0, minimum-scale=0.5">

<link rel="stylesheet" href="../../css/base/reset.css">
<link rel="stylesheet" href="../../css/base/common.css">

<link rel="stylesheet" href="../../bootstrap/css/bootstrap.css">

<link rel="stylesheet" href="../../css/src/open_api/api_openKey.css">

<!--[if IE]>
<script src="./ie/html5shive/dist/html5shive.min.js"></script>
<script src="./ie/pie/PIE.js"></script>
<script src="./ie/respond/dist/respond.min.js"></script>
<![endif] -->

<title> Core EX Agent </title>
</head>
<body>
<!-- layout -->
<div id="wrap">
  <!-- =-=-=-=-=-=-=-=-=-=-= header#headBox =-=-=-=-=-=-=-=-=-=-= -->
  <header id="headBox">
    <div class="div">
      <h1>
        <div class="logo"></div>
        <span>Core EX Agent</span>
      </h1>

      <nav id="gnb">
        <ul>
          <li><a href="../main/main.html">메인</a></li>
          <li><a href="../main/deal.html">내역</a></li>
          <li><a href="../main/wallet.html">지갑</a></li>
          <li><a href="../main/api.html">API</a></li>
          <li><a href="../main/mypage_info.html">마이페이지</a></li>
          <li><a href="../main/store.html">상품소개</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div id="issuedBox">
      <div class="issued">
        <div class="close"></div>
        <div class="text">
          <p class="text_p">Open API Key 발급 완료</p>
          <br />
          <span>회원님의 Open API Key가 아래와 같이 발급되었습니다.</span>
          <span>Sceret Key는 최초 1회에 한 해 발급되며 추가적으로 확인하실 수 없으니,</span>
          <span>발급 받으신 Secret Key는 반드시 안전한 곳에 별도로 보관하여 주시기 바랍니다.</span>
          <span>Open API Key 타인 양도시 발생하는 피해로 인한 책임은 본인에게 있습니다.</span>
        </div>
        <div class="keyBox">
          <ul>
            <li><span class="li_t">Access Key</span> <input id="ac_id" value="vx76pptZMtiuxZa3guZxNHnf8kO4GYkNnFue5jT0" readonly> <button class="scan acc_scan">복사하기</button></li>
            <li><span class="li_t">Secret Key</span> <input id="se_id" value="ac76435tZM94oxa3gDZxNHnfOAZ4GYkNnFue5jT0" readonly> <button class="scan sec_scan">복사하기</button></li>
          </ul>
        </div>

        <p class="scan_alarm">Secret Key가 복사되었습니다.</p>
      </div>
  </div>

  <!-- =-=-=-=-=-=-=-=-=-=-= section#viewBox =-=-=-=-=-=-=-=-=-=-= -->
  <div class="viewBox">
    <div class="view_title">
      <h2>OPEN API</h2>
      <button type="button" class="api_issued"> Open API 발급받기 </button>
      <div class="title_line"></div> 
    </div>

    <div class="content">
      <div class="checkBox">
        <div class="openkey_ex">
         <p> - Open API Key 토큰의 유효 기간은 1년이며 연장은 불가합니다. 유효 기간 만료 후 Open API를 계속하여 사용하고자 하시는 분은 추가로 Open API Key를 발급받아 주시기 바랍니다. </p>
         <p> - Open API Key 토큰의 만료 기한은 Open API Key 관리 메뉴 내 Access key 하단 정보를 통해 확인 가능합니다. </p>
         <p> - 출금하기 API를 사용하시기 위해선 반드시 사용하실 IP 주소를 등록하셔야 하며, 해당 IP 주소로 접속 시에만 Open API를 사용하실 수 있습니다. (2021-05-06 부터 적용) </p>
        </div>

        <h3>Open API Key 관리</h3>
        <table>
          <thead>
            <tr>
              <th>Access Key</th>
              <th>허용 IP주소</th>
              <th>관리</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <span>vx76pptZMtiuxZa3guZxNHnf8kO4GYkNnFue5jT0</span>
                <span class="date">2022.05.04 13:49 만료</span>
              </td>
              <td><button>변경</button></td>
              <td><button>삭제</button></td>
            </tr>
            <tr>
              <td>
                <span>vx76pptZMtiuxZa3guZxNHnf8kO4GYkNnFue5jT0</span>
                <span class="date">2022.05.04 13:49 만료</span>
              </td>
              <td><button>변경</button></td>
              <td><button>삭제</button></td>
            </tr>
          </tbody>
        </table>

         <div class="key_ex">
          <p class="key_ex_title">&#42; 주의사항</p>
          <p> - Corepay 탈퇴하기를 통해 탈퇴 진행시에는 Open API Key가 삭제됩니다.</p>
         </div>
      </div>

      <div class="key_management">
        <div class="number">1</div>
        <h4>CorePay 라이브러리를 추가합니다.</h4>
        
        <p>결제가 필요한 곳에 CorePay의 한줄 자바스크립트 라이브러리를 추가합니다.</p>
        <p>CorePay는 jQuery 기반으로 동작하기 때문에 jQuery 1.0 이상이 반드시 설치되어 있어야 합니다.</p>
        <p>CorePay 라이브러리 파일이 로드되면 window.IMP 변수에 접근이 가능합니다. </p>

  
          <pre brush:php class="code01">
            <code> &lt;script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.min.js"&gt; &lt;/script&gt; </code>
            <code> &lt;script type="text/javascript" src="https://cdn.corepay.kr/js/corepay.payment-1.1.5.js"&gt; &lt;/script&gt; </code>
          </pre>


        <a href="#"><span>CorePay 라이브러리 전체버전 보기</span></a>
      </div>

      <div class="key_management">
        <div class="number">2</div>
        <h4>window.IMP 변수를 초기화합니다. </h4>
        
        <p>회원가입 후 생성된 가맹점 식별코드를 이용해서 window.IMP 변수를 초기화합니다. </p>
        <p>가맹점 식별코드는 관리자 페이지 로그인 한 뒤 시스템설정 - 내 정보에서 확인할 수 있습니다.</p>
        <p>IMP.init()호출은 최초 1회 이루어져야하며, 페이지 로딩 단계에서 미리 호출해두시면 보다 효과적입니다.</p>

        <pre brush:php class="code02">
          <code> var IMP = window.IMP; // 생략가능 </code>
          <code> IMP.init('iamport'); // 'iamport' 대신 부여받은 "가맹점 식별코드"를 사용 </code>
        </pre>
      </div>

      <div class="key_management key_m03">
        <div class="number">3</div>
        <h4>결제를 요청합니다. </h4>
        
        <p>결제 창을 띄워야 하는 페이지에서 아래의 IMP.request_pay({파라메터})함수를 호출합니다.</p>
        <p>결제에 필요한 아래의 파라메터만 입력하고 함수를 실행하면 관리자 페이지에서 선택한 PG사의 결제 창이 실행됩니다.</p>
        <p>복수PG를 이용할 경우 pg파라메터의 값만 바꿔넣으면 원하는 PG사의 결제 창으로 결제가 진행됩니다.</p>

        <pre brush:php class="code03">
          <code>IMP.request_pay({ </code>
          <code>    pg : 'inicis', // version 1.1.0부터 지원.</code>
          <code>    pay_method : 'card',</code>
          <code>    merchant_uid : 'merchant_' + new Date().getTime(),</code>
          <code>    name : '주문명:결제테스트',</code>
          <code>    amount : 14000,</code>
          <code>    buyer_email : 'iamport@siot.do',</code>
          <code>    buyer_name : '구매자이름',</code>
          <code>    buyer_tel : '010-1234-5678',</code>
          <code>    buyer_addr : '서울특별시 강남구 삼성동',</code>
          <code>    buyer_postcode : '123-456',</code>
          <code>    m_redirect_url : 'https://www.yourdomain.com/payments/complete'</code>
          <code>}, function(rsp) {</code>
          <code>    if ( rsp.success ) {</code>
          <code>        var msg = '결제가 완료되었습니다.';</code>
          <code>        msg += '고유ID : ' + rsp.imp_uid;</code>
          <code>        msg += '상점 거래ID : ' + rsp.merchant_uid;</code>
          <code>        msg += '결제 금액 : ' + rsp.paid_amount;</code>
          <code>        msg += '카드 승인번호 : ' + rsp.apply_num;</code>
          <code>    } else {</code>
          <code>        var msg = '결제에 실패하였습니다.';</code>
          <code>        msg += '에러내용 : ' + rsp.error_msg;</code>
          <code>    }</code>
          <code>    alert(msg);</code>
          <code>});</code>
        </pre>

        <table>
          <thead>
            <tr>
              <th>파라메터명</th>
              <th>파라메터값</th>
            </tr>
          </thead>

          <tbody>
            <tr>
              <td>PG</td>
              <td>'kakao':카카오페이, html5_inicis':이니시스(웹표준결제), 'nice':나이스페이, 'jtnet':제이티넷, 'uplus':토스페이먼츠, 'danal':다날, 'payco':페이코, 'syrup':시럽페이, 'paypal':페이팔</td>
            </tr>

            <tr>
              <td>pay_method</td>
              <td>'samsung':삼성페이, 'card':신용카드, 'trans':실시간계좌이체, 'vbank':가상계좌, 'phone':휴대폰소액결제</td>
            </tr>

            <tr>
              <td>m_redirect_url</td>
              <td>모바일 결제시, 결제가 끝나고 랜딩되는 URL을 지정 (카카오페이, 페이코, 다날의 경우는 필요없음. PC와 마찬가지로 callback함수로 결과가 떨어짐)</td>
            </tr>
          </tbody>
        </table>

        <a href="#"><span>IMP.request_pay() 파라메터 상세보기</span></a>
      </div>

      <div class="key_management">
        <div class="key_m04_left">
          <div class="number">4</div>
          <h4>결제결과를 검증합니다. </h4>
          
          <p>결제창에서 결제가 완료되면 IMP.request_pay(param, callback) 실행 후</p>
          <p>callback함수가 호출(PC)되거나 m_redirect_url로 이동(모바일)하게 됩니다.</p>
          <br />
          <p>결제정보 위변조 가능성에 대비해 실제 결제된 정보를 imp_uid(아임포트 거래고유번호) </p>
          <p>또는 merchant_uid(가맹점에서 전달한 주문고유번호)를 활용해</p>
          <p>가맹점의 서버단에서 REST API로 조회 후 검증할 수 있습니다.</p>
          <br />
          <p>REST API로 조회된 결제정보의 status == 'paid'여부를 체크하고 </p>
          <p>amount 가 가맹점에서 계산한 {실제 주문금액}과 일치하는지 최종 검증이 필요합니다.</p>
        </div>

        <div class="key_m04_right">
        </div>
      </div>

      <div class="key_management key_m05">
          <div class="number">5</div>
        <h4>CorePay 결제연동 완료 </h4>
        
        <p>웹사이트에서 테스트 결제를 실행할 수 있습니다.</p>
        <p>PG가입 후 테스트모드를 OFF하고 정보를 입력하면</p>
        <p>실제로 결제기능을 사용할 수 있습니다.</p>
        <div class="img"></div>
      </div>
    </div>

  </div>
</div>
<!--script -->
<script src="../../js/base/jquery-3.5.1.min.js"></script>
<script src="../../js/base/jquery-ui.min.js"></script>

<script src="../../bootstrap/js/bootstrap.min.js"></script>

<script src="../../js/src/open_api/api_openKey.js"></script>
</body>
</html>